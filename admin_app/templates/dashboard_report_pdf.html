<html>
<head>
    <style>
        body { font-family: Arial; font-size: 12px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #444; padding: 6px; }
        th { background: #f0f0f0; }
        h2, h3 { margin-bottom: 5px; }
    </style>
</head>
<body>

<h2>Sales Report</h2>
<p>Period: {{ start }} to {{ end }}</p>

<h3>Summary</h3>
<table>
<tr>
    <th>Total Orders</th>
    <th>Gross Sales</th>
    <th>Discount</th>
    <th>Net Sales</th>
</tr>
<tr>
    <td>{{ sales.count }}</td>
    <td>{{ sales.sales }}</td>
    <td>{{ sales.discount }}</td>
    <td>{{ sales.net }}</td>
</tr>
</table>

<h3>Top Products</h3>
<table>
<tr><th>Product</th><th>Qty</th><th>Revenue</th><th>Percentage</th></tr>
{% for p in products %}
<tr>
    <td>{{ p.name }}</td>
    <td>{{ p.quantity }}</td>
    <td>{{ p.revenue }}</td>
    <td>{{ p.percentage }}</td>
</tr>
{% endfor %}
</table>

<h3>Top Categories</h3>
<table>
<tr><th>Category</th><th>Qty</th><th>Revenue</th><th>Percentage</th></tr>
{% for c in categories %}
<tr>
    <td>{{ c.name }}</td>
    <td>{{ c.quantity }}</td>
    <td>{{ c.revenue }}</td>
    <td>{{ c.percentage }}</td>
</tr>
{% endfor %}
</table>

<h3>Recent Orders</h3>
<table>
<tr><th>Order ID</th><th>Customer</th><th>Date</th><th>Total</th></tr>
{% for o in orders %}
<tr>
    <td>{{ o.orderID }}</td>
    <td>{{ o.user.firstname }}</td>
    <td>{{ o.created_at|date:"Y-m-d" }}</td>
    <td>{{ o.total_price }}</td>
</tr>
{% endfor %}
</table>

</body>
</html>
