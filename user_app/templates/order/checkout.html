{% extends 'base.html' %}

{% block content %}

<!-- Two Column Layout -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <form action="" method="post" id="checkout-form">
        {% csrf_token %}
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

            <!-- Left Section -->
            <div class="lg:col-span-2 space-y-6">

                <!-- Delivery Address Card -->
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h2 class="text-xl font-bold text-gray-900 mb-6">Delivery Address</h2>

                    <div class="space-y-4" id="newly-added-address">

                        {% include 'order/address_list.html' %}
                    </div>
                    <div class="mt-6">
                        <a href="" hx-get="{% url 'addNewAddress' %}" hx-target="#newly-added-address"
                            hx-swap="beforeend"
                            class="inline-block px-4 py-2 border-2 border-green-500 text-green-600 font-medium rounded-lg hover:bg-green-50 transition">
                            Add a new address
                        </a>

                    </div>

                    <!-- Add New Address Button -->

                </div>

                <!-- Order Summary Card -->
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h2 class="text-xl font-bold text-gray-900 mb-6">Order Summary</h2>

                    <div class="space-y-6">
                        <!-- Product 1 -->
                        {% for item in item %}
                        <div class="flex items-center justify-between pb-6 border-b border-gray-200">
                            <div class="flex items-center space-x-4 flex-1">
                                <!-- Product Image -->

                                <div class="flex-shrink-0">
                                    {% with item.product.product.images.all as image %}

                                    {% if image %}
                                    <img src="{{image.0.image.url}}" alt="Jade Plant"
                                        class="w-24 h-24 object-cover rounded-lg">
                                    {% endif %}

                                    {% endwith %}
                                </div>

                                <!-- Product Details -->

                                <div class="flex-1">
                                    <h3 class="text-base font-semibold text-gray-900">{{item.product.product.name}}</h3>
                                    <p class="text-sm text-gray-500 mt-1">{{item.product.weight}} g </p>
                                    <p class="text-sm text-gray-500 mt-1">Pack of {{item.quantity}}</p>
                                </div>

                            </div>

                            <!-- Product Price -->
                            <div class="text-lg font-semibold text-gray-900 ml-4">
                                {{item.row_total}}
                            </div>
                        </div>
                        {% endfor %}

                    </div>
                </div>

            </div>

            <!-- Right Section - Price Details (1/3 width) -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-lg shadow-sm p-6 sticky top-6">
                    <h2 class="text-gray-600 font-semibold tracking-wide mb-4 border-b border-gray-300 pb-2">PRICE
                        <span class="text-black">DETAILS</span>
                    </h2>

                    <div class="space-y-4">
                        <!-- Subtotal -->
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700">Subtotal</span>
                            <span class="text-gray-900 font-medium">Rs. {{totalprice}}</span>
                        </div>

                        <!-- Shipping -->
                        <div class="flex justify-between items-center">
                            <span class="text-gray-700">Shipping Charge</span>
                            <span class="text-gray-900 font-medium">Rs.0.00</span>
                        </div>

                        <!-- Total -->
                        <div class="flex justify-between items-center pt-2">
                            <span class="text-lg font-bold text-gray-900">Total</span>
                            <span class="text-lg font-bold text-gray-900" id="cod-extra-price">Rs. {{totalprice}}</span>
                        </div>
                    </div>


                    <div class="w-full max-w-sm mx-auto mt-8">
                        <h2 class="text-gray-600 font-semibold tracking-wide mb-4 border-b border-gray-300 pb-2">
                            PAYMENT <span class="text-black">METHOD</span>
                        </h2>


                        <div class="flex flex-col space-y-3">
                            <!-- Wallet -->
                            <label
                                class="flex items-center border border-gray-300 rounded-lg p-3 cursor-pointer hover:border-green-500 transition">
                                <input type="radio" name="payment_method" value="wallet"
                                    class="w-4 h-4 text-green-600 focus:ring-green-500" />
                                <span class="ml-3 text-gray-700 font-medium">Wallet</span>
                            </label>

                            <!-- Razorpay -->
                            <label
                                class="flex items-center border border-gray-300 rounded-lg p-3 cursor-pointer hover:border-green-500 transition">
                                <input type="radio" name="payment_method" value="razorpay"
                                    class="w-4 h-4 text-green-600 focus:ring-green-500" />
                                <img src="https://upload.wikimedia.org/wikipedia/commons/8/89/Razorpay_logo.svg"
                                    alt="Razorpay" class="ml-3 h-5" />
                            </label>

                            <!-- Cash on Delivery -->
                            <label
                                class="flex items-center border border-gray-300 rounded-lg p-3 cursor-pointer hover:border-green-500 transition">
                                <input type="radio" name="payment_method" value="cod"
                                    class="w-4 h-4 text-green-600 focus:ring-green-500" checked />
                                <span class="ml-3 text-gray-700 font-medium">Cash on Delivery</span>
                            </label>
                        </div>

                    </div>

                    <!-- Place Order Button -->
                    <div class="mt-8">
                        <!-- <input type="hidden" name="selected_address" value="{{ default_address.id }}"> -->
                        <button type="submit"
                            class="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg transition shadow-sm">
                            Place Your Order
                        </button>
                    </div>
                </div>
            </div>
    </form>
</div>


<!-- Confirmation Modal -->
<div id="paymentConfirmModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
  <div class="bg-white rounded-lg p-6 shadow-md text-center">
    <h2 class="text-xl font-semibold mb-4">Proceed to Payment?</h2>
    <p>Do you want to continue with Razorpay payment?</p>
    <div class="mt-6 flex justify-center gap-4">
      <button id="confirm-payment" class="bg-green-500 text-white px-4 py-2 rounded">Yes</button>
      <button id="cancel-payment" class="bg-gray-400 text-white px-4 py-2 rounded">No</button>
    </div>
  </div>
</div>
<!-- modal ends -->



{% endblock %}