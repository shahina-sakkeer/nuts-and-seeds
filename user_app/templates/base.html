<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuts & Seeds</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Toastify -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- htmx -->
    <script src="https://unpkg.com/htmx.org@1.9.6"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- razorpay interface -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <!-- cart update icon -->
    <script src="{% static 'js/cart.js' %}"></script>

</head>

<body class="min-h-screen flex flex-col bg-white">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Poppins', sans-serif;
        }

        /* Image zoom effect on hover */
        .image-zoom-container {
            overflow: hidden;
        }

        .image-display img {
            transition: transform 0.5s ease;
        }

        .image-display:hover img {
            transform: scale(1.5);
        }

        .image-radio {
            display: none;
        }

        .main-image {
            display: none;
        }

        #img1:checked~.image-display #main-img1,
        #img2:checked~.image-display #main-img2,
        #img3:checked~.image-display #main-img3 {
            display: block;
        }

        #img1:checked~.thumbnails label[for="img1"],
        #img2:checked~.thumbnails label[for="img2"],
        #img3:checked~.thumbnails label[for="img3"] {
            border-color: #ea580c;
            box-shadow: 0 0 0 2px #ea580c;
        }


        .qty-input::-webkit-outer-spin-button,
        .qty-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .sparkle {
            position: absolute;
            background-color: gold; 
            border-radius: 50%;
            opacity: 0;
            animation: sparkle-fade-out 0.8s forwards;
            pointer-events: none; 
            }

            @keyframes sparkle-fade-out {
            0% {
                transform: scale(0.2);
                opacity: 1;
            }
            100% {
                transform: scale(1.5) translateY(-20px); 
                opacity: 0;
            }
            }
 
    </style>

    <!-- Navbar -->
    <nav class="bg-white shadow-sm sticky top-0 z-50 border-b border-orange-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex-shrink-0">
                    <a href="{% url 'home' %}"><span class="text-2xl font-bold text-orange-500">Nuts & Seeds</span></a>
                </div>

                <!-- Navigation Links -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="{% url 'home' %}" class="text-orange-600 font-medium hover:text-orange-700 transition">Home</a>
                    <a href="{% url 'all_products' %}" class="text-gray-600 hover:text-orange-600 transition">Products</a>
                    <a href="{% url 'aboutUs' %}" class="text-gray-600 hover:text-orange-600 transition">About Us</a>
                    <a href="" class="text-gray-600 hover:text-orange-600 transition">Contact</a>
                </div>

                <!-- Right Side Icons -->
                <div class="flex items-center space-x-4">
                    <!-- Search Bar -->
                    <form action="">
                        <div class="hidden sm:block">
                            <input type="hidden" id="category-id" name="category_id" value="{{ cat.id|default:'' }}">
                            <input type="text" name="search" placeholder="Search..."
                                class="px-4 py-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 w-48 lg:w-64"
                                hx-get="{% url 'filtering' %}" hx-trigger="keyup changed delay:300ms"
                                hx-target="#category-product" hx-swap="innerHTML" hx-include="#category-id">
                        </div>
                    </form>

                    <!-- Wishlist Icon -->
                     <a href="{% url 'allWishlist' %}"><button class="p-2 hover:bg-orange-100 rounded-lg transition">
                        <i class="fa-regular fa-heart fa-lg text-orange-600"></i>
                    </button>
                    </a>

                    <!-- Cart Icon -->
                    <a href="{% url 'showCart' %}">
                        <button class="p-2 hover:bg-orange-100 rounded-lg transition relative">
                            <i class="fa-solid fa-cart-shopping fa-lg text-orange-600"></i>
                            <span id="cart-count"
                            class="absolute -top-1 -right-1 bg-orange-500 text-white text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full shadow">
                            {{ cart_item_count }}
                            </span>
                        </button>
                    </a>


                    <!-- Profile icon -->
                    <a href="{% url 'userDasboard' %}"><i class="fa-regular fa-user fa-lg text-orange-600 hover:text-orange-700"></i></a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Global Loader -->
    <div id="loader"
        class="fixed inset-0 bg-white bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="w-12 h-12 border-4 border-orange-600 border-t-transparent rounded-full animate-spin"></div>
    </div>

    {% include 'messages.html' %}

    <main class="flex-grow">
    {% block content %}



    {% endblock %}
    </main>

    <footer class="bg-orange-50 border-t border-orange-200 mt-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        
        <div class="flex flex-wrap justify-center gap-8 mb-8">
            <a href="#" class="text-orange-700 hover:text-orange-900 transition">About Us</a>
            <a href="#" class="text-orange-700 hover:text-orange-900 transition">Contact</a>
            <a href="#" class="text-orange-700 hover:text-orange-900 transition">Privacy Policy</a>
            <a href="#" class="text-orange-700 hover:text-orange-900 transition">Terms of Service</a>
        </div>

        <div class="text-center text-orange-600 text-sm">
            <p>&copy; 2025 Nuts & Seeds. All rights reserved.</p>
        </div>
    </div>
    </footer>


<meta name="csrf-token" content="{{ csrf_token }}">
<script>
  document.body.addEventListener('htmx:configRequest', (event) => {
    event.detail.headers['X-CSRFToken'] = document.querySelector('[name=csrfmiddlewaretoken]')?.value ||
                                          document.querySelector('meta[name="csrf-token"]')?.content;
  });
</script>



    <!-- Modal for hidding after delete address confirmation -->
    <script>
        document.body.addEventListener('htmx:afterRequest', function (evt) {

        const modalEl = document.querySelector('.modal.show');
        if (modalEl) {
            const modal = bootstrap.Modal.getInstance(modalEl);
            if (modal) {
                modal.hide();
            }
        }

    
        document.querySelectorAll('.modal-backdrop').forEach(el => el.remove());
        document.body.classList.remove('modal-open');
        document.body.style.removeProperty('padding-right');
    });
    </script>



<!-- sparkling effects on wishlist -->
<script>
    document.addEventListener("click", function (event) {
    if (event.target.closest(".sparkle-btn")) {

        const numSparkles = 10;
        const sparkleSize = 5;

        for (let i = 0; i < numSparkles; i++) {
            const sparkle = document.createElement("span");
            sparkle.classList.add("sparkle");

            const x = event.clientX + (Math.random() - 0.5) * 50;
            const y = event.clientY + (Math.random() - 0.5) * 50;

            sparkle.style.left = `${x}px`;
            sparkle.style.top = `${y}px`;
            sparkle.style.width = `${sparkleSize}px`;
            sparkle.style.height = `${sparkleSize}px`;

            document.body.appendChild(sparkle);

            sparkle.addEventListener("animationend", () => sparkle.remove());
        }
    }
});
</script>


<!-- script used for contains the new address in checkout page -->
<script>
document.body.addEventListener("address-added", function(event) {
    document.querySelector("#address-section")
        .insertAdjacentHTML("beforeend", event.detail.html);
});
</script>


<!-- loader for every pages -->

<script>
document.addEventListener("DOMContentLoaded", function () {
    const loader = document.getElementById("loader");

    document.addEventListener("click", function (e) {  
        const target = e.target.closest("a");

        if (target && target.href && !target.href.startsWith("#")) {
            loader.classList.remove("hidden");
        }
    });

    window.addEventListener("load", function () {
        loader.classList.add("hidden");
    });
});
</script>

<script>
document.body.addEventListener('htmx:request', () => {
    document.getElementById('loader').classList.remove('hidden');
});

document.body.addEventListener('htmx:afterOnLoad', () => {
    document.getElementById('loader').classList.add('hidden');
});
</script>



</body>

</html>